<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Book a Spa Session</title>
    <link rel="stylesheet" href="/css/spa-session.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
</head>
<body><!-- Background video -->
  <video autoplay muted loop playsinline class="bg-video">
    <source src="https://media.gettyimages.com/id/1043680100/video/spa-concept-with-zen-stone-in-stream.mp4?s=mp4-640x640-gi&k=20&c=qJ9eOJutWlC2M5-V-LeOKIpKX6dKYNAf-q34Y9W_5aw=" type="video/mp4">
    Your browser does not support the video tag.
  </video>
  <!-- Optional dark overlay -->
  <div class="overlay"></div>
    <%- include('partials/navbar') %>
    <div class="form-container">
        <h1 class="animate-title">Book Your Spa Session</h1>
        <form id="bookingForm" action="/spa-session" method="POST">
            <div class="form-group">
                <input type="text" name="firstName" placeholder="First Name" required pattern="^[A-Za-z]+$">
            </div>
            <div class="form-group">
                <input type="text" name="lastName" placeholder="Last Name" required pattern="^[A-Za-z]+$">
            </div>
            <div class="form-group">
                <input type="email" name="email" placeholder="Email" required>
            </div>
            <div class="form-group">
                <input type="tel" name="phone" placeholder="Phone Number" required pattern="^[0-9]{10}$">
            </div>
            <div class="form-group">
                <label for="hours">Session Duration (Max 6 Hours):</label>
                <select name="hours" id="hours" required>
                    <% for(let i = 1; i <= 6; i++) { %>
                        <option value="<%= i %>"><%= i %> Hour<%= i > 1 ? 's' : '' %></option>
                    <% } %>
                </select>
            </div>
            <div class="form-group">
                <textarea name="message" rows="5" placeholder="Any special requests or preferences?"></textarea>
            </div>
            <button type="submit" class="btn">Book Now</button>
        </form>
    </div>
    

    <script>
        document.getElementById('bookingForm').addEventListener('submit', function (e) {
            const hours = parseInt(document.getElementById('hours').value);
            if (hours > 6) {
                e.preventDefault();
                alert('Session cannot exceed 6 hours.');
            }
        });
        document.getElementById('bookingForm').addEventListener('submit', async function (e) {
        e.preventDefault();

        const form = e.target;
        const formData = new FormData(form);
        const data = Object.fromEntries(formData.entries());

        if (parseInt(data.hours) > 6) {
            alert('Session cannot exceed 6 hours.');
            return;
        }

        try {
            const response = await fetch('/spa-session', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            const result = await response.json();
            if (result.success) {
                alert('üéâ Booking Successful! We will contact you shortly.');
                form.reset();
            } else {
                alert('‚ö†Ô∏è Booking failed. Please check your inputs.');
            }
        } catch (error) {
            alert('‚ö†Ô∏è An error occurred while booking. Please try again.');
            console.error(error);
        }
    });
    </script>
</body>
</html>
